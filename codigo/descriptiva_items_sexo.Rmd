---
title: "Descriptiva preguntas Termómetro, por género"
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
  word_document: default
---


```{r echo=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning=FALSE)
library(tidyverse)
library(kableExtra)
library(readr)
library(ufs)
```


```{r, warning=FALSE}
datos_v4 <- read_delim("~/brvulnerable/datos/Termômetro Social COVID-19_Versão 4.0.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE, show_col_types = F)
# Cambiar el género a factor
datos_v4 <- rename(datos_v4, "s"="Sexo/Gênero:")
# Seleccionamos registros donde el sexo es hombre o mujer
datos_v4 <- datos_v4 %>% 
 mutate(sexo=as.factor(s)) %>%
 filter(sexo %in% c("Homem", "Mulher"))          
# Tamaño n=3003 registros
# table(datos_v4[[15]], useNA = "always")
#nsexo <- datos_v4 %>% 
#  group_by(sexo) %>% 
#  summarise(n=n())
```

\newpage

## Medidas para evitar la infección COVID - con reshape 

```{r tabla1_pivot}
vulnerables <- datos_v4 %>% 
  select(c(322,42:53))
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]
  
kable(vulnerables2,col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 1: Que medidas você têm adotado para não ficar infectado com a COVID-19, de acordo com as recomendações do Ministério da Saúde?") %>% 
  kable_paper(full_width = F) %>% 
  column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage


\newpage

## Confianza en las instituciones

```{r tabla2}
vulnerables <- datos_v4 %>% 
  select(322,75:81)
# Ojo. Revisar. Las respuestas no son iguales
names(vulnerables) <- c("sexo","Governo Federal", "Governo Estadual", "Governo Municipal", "Hospital", "Hospital de Campanha", "Unidade de Pronto Atendimento (UPA) / Emergência", "Unidade Básica de Saúde/ Posto de Saúde")
vulnerables <- vulnerables %>% 
  mutate(across(2:8, as.factor)) %>% 
  mutate(across(2:8, as.numeric)) %>% 
  mutate(across(2:8, recode,"1"=1, "2"=1, "3"=0,"4"=0, .missing=0 ))
vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:7, times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 2: Confiança na capacidade para enfrentar a COVID-19") %>% 
    kable_paper(full_width = F) %>% 
  column_spec(1, width = "30em")%>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Fuente de información sobre la infección

```{r tabla3}
vulnerables <- datos_v4 %>% 
  select(c(322,82:94))
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 3: Qual fonte de informação você utiliza para se manter informado sobre a COVID-19?") %>% 
    kable_paper(full_width = F) %>% 
  column_spec(1, width = "30em")%>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Estado anímico

```{r tabla4}
vulnerables <- datos_v4 %>% 
  select(c(322,99:107))
# Revisar lo que pasa con variable 98
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 4: Comparando com o período anterior a COVID-19, como você tem se sentido na maior parte do tempo?") %>% 
    kable_paper(full_width = F) %>% 
  column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Actividades de la vida diaria

```{r tabla4bis}
vulnerables <- datos_v4 %>% 
  select(c(322,108:116))
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 4: Nos últimos meses, o que você tem feito para lidar com a atual situação da pandemia COVID-19?") %>% 
    kable_paper(full_width = F) %>% 
  column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Situaciones observadas de violencia

```{r tabla5}
vulnerables <- datos_v4 %>% 
  select(c(322,143:164))
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 5: Quais das situações abaixo você tem VISTO/PRESENCIADO NO SEU LOCAL DE MORADIA, VIZINHANÇA ou COMUNIDADE durante à pandemia da COVID-19?") %>% 
    kable_paper(full_width = F) %>% 
    column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Situaciones sufridas de violencia

```{r tabla6}
vulnerables <- datos_v4 %>% 
  select(c(322,167:188))
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 6: Quais das situações abaixo vocé e/ou sua família tem vivido no seu local de moradia, vizinhança ou comunidade durante à pandemia da COVID-19?")%>% 
  kable_paper(full_width = F) %>% 
  column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Ayuda después del diagnóstico COVID 

```{r tabla7}
vulnerables <- datos_v4 %>% 
  select(c(322,206:214))
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 7: A quem você recorreu após diagnosticado com COVID-19?") %>% 
    kable_paper(full_width = F) %>% 
    column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Fuentes de información sobre vacunas

```{r tabla8}
vulnerables <- datos_v4 %>% 
  select(c(322,247:259))
subconj <-names(vulnerables[2:ncol(vulnerables)])
pr <- as.numeric(ncol(vulnerables))
l <- str_length(subconj)
m <- str_locate(subconj, "=")
n <- str_sub(subconj, m[,2]+1, l-1)
names(vulnerables) <- c("sexo",n)
# names(vulnerables)[2:ncol(vulnerables)] <- n
# names(vulnerables)[1] <- "sexo"

vulnerables <- vulnerables %>%
  mutate(across(2:ncol(vulnerables), as.factor)) %>% 
  mutate(across(2:ncol(vulnerables), as.numeric)) %>% 
  mutate(across(2:ncol(vulnerables), ~ recode(.x, "1" = 0, "2" = 1)))

vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:(pr-1), times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 8: Qual é a fonte de informação mais comum que você recorre para obter informações sobre as vacinas contra a COVID-19?") %>% 
    kable_paper(full_width = F) %>% 
    column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```

\newpage

## Nivel de confianza sobre las vacunas

```{r tabla9}
vulnerables <- datos_v4 %>% 
  select(c(322,261:263))
subconj <-names(vulnerables[,2:ncol(vulnerables)])
names(vulnerables) <- c("sexo", "Governo Federal", "Governo Estadual", "Governo Municipal")

vulnerables <- vulnerables %>% 
  mutate(across(2:4, as.factor)) %>% 
  mutate(across(2:4, as.numeric)) %>% 
  mutate(across(2:4, recode,"1"=1, "2"=1, "3"=0,"4"=0, .missing=0 ))
vulnerables2 <- vulnerables %>% 
  pivot_longer(cols = !c(sexo),
               names_to = c("respuesta"),
               values_to = c("valor")) %>%
  mutate(orden=rep(1:3, times=3003)) %>% 
  group_by(respuesta,sexo,orden) %>% 
  summarise(acordo=sum(valor),
            n=n()) %>% 
  arrange(orden,sexo) %>% 
  pivot_wider(names_from = sexo, 
              id_cols=respuesta,
              values_from = c(acordo,n)) %>% 
  mutate(porc_h=round(acordo_Homem/n_Homem*100,1),
         porc_m=round(acordo_Mulher/n_Mulher*100,1)) %>% 
  select(-c(4:5))
vulnerables2 <- vulnerables2[,c(1,2,4,3,5)]

kable(vulnerables2, col.names= c("Respuesta", "Frequência", "Porcentagem (n=1726)","Frequência", "Porcentagem (n=1277)"), digits = 1,
      caption="Tabela 9: Qual o seu nível de confiança no Governo Federal sobre às vacinas contra a COVID-19?") %>% 
    kable_paper(full_width = F) %>% 
    column_spec(1, width = "30em") %>% 
  add_header_above(c(" ", "Homem" = 2, "Mulher" = 2))
```
